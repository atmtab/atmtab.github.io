<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>IT Park ‚Ä¢ Smart Search (Demo)</title>
<style>
  :root{
    --bg:#f6f7fb; --panel:#ffffff; --ink:#1b1f23; --muted:#6b7280; --line:#e6e8ef;
    --green:#86d243; --blue:#2f6df6; --shadow:0 10px 25px rgba(17,24,39,.06);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.35 "Inter",system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .app{display:grid;grid-template-columns:240px 1fr;min-height:100vh}
  .sidebar{background:#fff;border-right:1px solid var(--line);padding:18px 14px;position:sticky;top:0;height:100vh}
  .brand{display:flex;align-items:center;gap:10px;padding-bottom:18px;border-bottom:1px solid var(--line);margin-bottom:12px}
  .brand-logo{width:34px;height:34px;border-radius:50%;display:grid;place-items:center;background:var(--green);color:#fff;font-weight:700}
  .nav .item{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;text-decoration:none;color:#2a2f36}
  .nav .item:hover{background:#f1f5f9}
  .nav .item.active{background:#eaffd9;color:#1f3d1f;font-weight:600}

  .main{padding:18px 22px}
  .topbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
  .headline{font-size:24px;font-weight:800;margin:0 0 4px}
  .toggle{background:#fff;border:1px solid var(--line);border-radius:999px;padding:4px;display:flex;gap:4px}
  .toggle button{border:0;padding:8px 12px;border-radius:999px;background:transparent;cursor:pointer;color:#334155}
  .toggle button.active{background:#eaffd9;color:#1f3d1f;font-weight:700}

  .search{display:flex;gap:8px;width:100%;background:#fff;border:1px solid var(--line);border-radius:12px;padding:10px;box-shadow:var(--shadow);margin-bottom:12px}
  .input{flex:1;border:1px solid var(--line);border-radius:10px;padding:10px 12px}
  .btn{border:0;background:var(--green);color:#0b2f0b;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
  .btn.ghost{background:#fff;border:1px solid var(--line);color:#111827}

  .chips{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
  .chip{border:1px solid var(--line);background:#fff;padding:6px 10px;border-radius:999px;cursor:pointer}
  .chip.active{background:#eaffd9;border-color:#d9f7b4;color:#1f3d1f;font-weight:600}

  .ai-box{background:#fff;border:1px solid var(--line);border-radius:12px;box-shadow:var(--shadow);padding:12px 14px;margin:12px 0}
  .ai-text{white-space:pre-wrap}

  .cards{display:grid;gap:10px}
  .card{position:relative;border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff;display:grid;gap:8px}
  .title{font-weight:700}
  .row{display:flex;gap:8px;flex-wrap:wrap}
  .tag{background:#f3f4f6;color:#475569;padding:4px 8px;border-radius:999px;font-size:12px}
  .pill{font-size:12px;padding:4px 8px;border-radius:8px}
  .pill.green{background:#ddf9c7;color:#174417}
  .pill.blue{background:#e0ebff;color:#1e3a8a}
  .fp-badge{position:absolute;top:10px;right:10px;background:#fff;border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-size:12px;box-shadow:0 2px 8px rgba(0,0,0,.05)}

  .skeleton{position:relative;overflow:hidden;background:#f1f5f9;border-radius:8px;height:14px}
  .skeleton::after{content:"";position:absolute;inset:0;transform:translateX(-100%);background:linear-gradient(90deg,transparent,rgba(255,255,255,.6),transparent);animation:shine 1.3s infinite}
  @keyframes shine{to{transform:translateX(100%)}}
  .placeholder{text-align:center;color:var(--muted);margin-top:20px}

  @media (max-width:880px){.app{grid-template-columns:1fr}.sidebar{display:none}.search{flex-wrap:wrap}.input{min-width:100%}}
  
  /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –¥–µ–º–æ */
  a[href*="onrender.com"]:hover {
    background: #1d4ed8 !important;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(47, 109, 246, 0.3);
  }
</style>
</head>
<body>
<div class="app">
  <aside class="sidebar">
    <div class="brand">
      <div class="brand-logo">IT</div>
      <div><div class="headline" style="font-size:16px">IT PARK</div><div style="font-size:12px;color:var(--muted)">Uzbekistan</div></div>
    </div>
    <nav class="nav">
      <a class="item" href="#">–ö–æ–º–ø–∞–Ω–∏–∏</a>
      <a class="item" href="#">–ó–∞–¥–∞—á–∏</a>
      <a class="item" href="#">–û—Ç—á—ë—Ç—ã</a>
      <a class="item active" href="#">Smart Search</a>
    </nav>
  </aside>

  <main class="main">
    <div class="topbar">
      <div>
        <h1 class="headline">Smart Search</h1>
        <div style="color:var(--muted)">–ü–æ–∏—Å–∫ —Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–≤ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é, –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º (focal point)</div>
        <div style="margin-top: 8px;">
          <a href="https://it-park-smart-search.onrender.com" target="_blank" style="background:var(--blue);color:#fff;text-decoration:none;display:inline-block;font-size:13px;padding:8px 12px;border-radius:10px;font-weight:700;transition:all 0.2s ease;">
            üöÄ –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –¥–µ–º–∫—É
          </a>
          <span style="color:var(--muted); font-size: 12px; margin-left: 8px;">
            (—Å —Ä–∞–±–æ—Ç–∞—é—â–∏–º API)
          </span>
        </div>
      </div>
      <div class="toggle" role="tablist" aria-label="–†–µ–∂–∏–º –ø–æ–∏—Å–∫–∞">
        <button id="mode-ai" class="active" aria-selected="true">AI</button>
        <button id="mode-filters" aria-selected="false">–§–∏–ª—å—Ç—Ä—ã</button>
      </div>
    </div>

    <div class="search">
      <input id="q" class="input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å... (–Ω–∞–ø—Ä–∏–º–µ—Ä: erp, —Ñ–∏–Ω—Ç–µ—Ö, –ú—É—Ö–ª–∏—Å–∞)" />
      <button class="btn" id="run">–ü–æ–∏—Å–∫</button>
      <button class="btn ghost" id="reset">–°–±—Ä–æ—Å</button>
    </div>

    <div id="chips" class="chips" style="display:none"></div>

    <div class="ai-box" id="aiBox" style="display:none">
      <div class="ai-text"><b>AI:</b> <span id="aiText"></span></div>
    </div>

    <div id="placeholder" class="placeholder">–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–π –∑–∞–ø—Ä–æ—Å, –∏ —è –ø–æ–¥–±–µ—Ä—É –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–≤ —Å —É—á—ë—Ç–æ–º —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –æ—Ç—Ä–∞—Å–ª–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ª–∏—Ü.</div>
    <div class="cards" id="cards" style="display:none"></div>
  </main>
</div>

<script>
/* ======= –î–ê–ù–ù–´–ï ======= */
const RESIDENTS = [
  { name:"OOO ¬´Sales Doctor Solutions¬ª", sector:["ERP-—Å–∏—Å—Ç–µ–º—ã","–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö","–°–£–ë–î","–ü–û –∑–∞–∫–∞–∑–Ω–æ–µ","–ú–µ–¥–∏—Ü–∏–Ω–∞"], status:"resident", region:"–†–µ–∑–∏–¥–µ–Ω—Ç IT-Park —Å 03.12.2019", contact:"+998958449889", extra:"–†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: BBB - 83 –°—Ä–µ–¥–Ω–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: SUVONOV OTABEK IRKINOVICH", focal:"Lazizbek Khudaev" },
  { name:"–û–û–û ¬´BIG DATA SCIENCE¬ª", sector:["Big Data","ERP-—Å–∏—Å—Ç–µ–º—ã"], status:"resident", region:"–†–µ–∑–∏–¥–µ–Ω—Ç IT-Park —Å 07.11.2019", contact:"+998909341343", extra:"–°—Ñ–µ—Ä–∞: –§–∏–Ω—Ç–µ—Ö –∏ –ë–∞–Ω–∫–∏ ‚Ä¢ –†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: D - 5 –ù–∏–∑–∫–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: FAZILOV JASUR ABDUXAKIMOVICH", focal:"Rufina Ismailova" },
  { name:"OOO ¬´MIRICO SYSTEMS¬ª", sector:["ERP-—Å–∏—Å—Ç–µ–º—ã","–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö","–°–£–ë–î","–ü–û –∑–∞–∫–∞–∑–Ω–æ–µ"], status:"resident", region:"–†–µ–∑–∏–¥–µ–Ω—Ç IT-Park —Å 03.12.2019", contact:"+998900006231", extra:"–°—Ñ–µ—Ä–∞: –§–∏–Ω—Ç–µ—Ö –∏ –ë–∞–Ω–∫–∏, –ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è, –ë–∏–∑–Ω–µ—Å —É—Å–ª—É–≥–∏ ‚Ä¢ –†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: BBB - 85 –°—Ä–µ–¥–Ω–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: SABDURAIMOV MIRZIYOD MUXTAROVICH", focal:"Sevinch UBAYDULLAYEVA" },
  { name:"OOO ¬´AGILE MEDIA GROUP¬ª", sector:["ERP-—Å–∏—Å—Ç–µ–º—ã","CRM-—Å–∏—Å—Ç–µ–º—ã"], status:"resident", region:"–†–µ–∑–∏–¥–µ–Ω—Ç IT-Park —Å 03.12.2019", contact:"+998909772474", extra:"–°—Ñ–µ—Ä–∞: –°–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ, –ë–∏–∑–Ω–µ—Å —É—Å–ª—É–≥–∏ ‚Ä¢ –†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: AA - 92 –í—ã—Å–æ–∫–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: STAMPLEVSKAYA LYUDMILA VYACHESLAV–û–í–ù–ê", focal:"Fatima Timirova" },
  { name:"OOO ¬´REALSOFT¬ª", sector:["ERP-—Å–∏—Å—Ç–µ–º—ã","DMS","–ü–û –∑–∞–∫–∞–∑–Ω–æ–µ","–ò–° –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è"], status:"resident", region:"–†–µ–∑–∏–¥–µ–Ω—Ç IT-Park —Å 03.12.2019", contact:"+998712058484", extra:"–°—Ñ–µ—Ä–∞: –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —É—Å–ª—É–≥–∏, –ë–∏–∑–Ω–µ—Å —É—Å–ª—É–≥–∏ ‚Ä¢ –†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: B - 56 –°—Ä–µ–¥–Ω–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: NASRULLAYEV HIKMATUL–õ–û HABIBULLOYEVICH", focal:"Lazizbek Khudaev" },
  { name:"–û–û–û " + "\"ADCOM BTC\"", sector:["–ö–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥","–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥"], status:"resident", region:"–†–µ–∑–∏–¥–µ–Ω—Ç IT-Park —Å 31.07.2025", contact:"+998910189009", extra:"–†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: B - 63 –°—Ä–µ–¥–Ω–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: YUNUSOV TOLMAS TOXIROVICH", focal:"Mukhlisa Sattarova" },
  { name:"–û–û–û " + "\"PROMO STAFF SOLUTIONS\"", sector:["–ö–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥","–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥"], status:"resident", region:"–†–µ–∑–∏–¥–µ–Ω—Ç IT-Park —Å 31.07.2025", contact:"+998909573434", extra:"–†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: BBB - 77 –°—Ä–µ–¥–Ω–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: TALIPOV ALISHER SABIROVICH", focal:"Mukhlisa Sattarova" },
  { name:"–û–û–û " + "\"TRANSPROEKT\"", sector:["–ö–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥","–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ü–û","–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ"], status:"resident", region:"–†–µ–∑–∏–¥–µ–Ω—Ç IT-Park —Å 31.07.2025", contact:"+998903450504", extra:"–†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: B - 58 –°—Ä–µ–¥–Ω–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: BO‚ÄòTTER CHRISTAN", focal:"Mukhlisa Sattarova" },
  { name:"–û–û–û " + "\"COMPLIANCE SHIELD\"", sector:["–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏","–î–∏—Å–ø–µ—Ç—á–µ—Ä—Å–∫–∏–µ —É—Å–ª—É–≥–∏"], status:"lead", region:"–õ–∏–¥ ‚Ä¢ –ó–∞—è–≤–∫–∞ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏", contact:"+998903338090", extra:"–†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏: B - 58 –°—Ä–µ–¥–Ω–∏–π ‚Ä¢ –î–∏—Ä–µ–∫—Ç–æ—Ä: RAXMATULLAYEV SHERUDXON BOXODIR O‚ÄòG‚ÄòLI", focal:"Mukhlisa Sattarova" }
];

const ALL_TAGS = Array.from(new Set(RESIDENTS.flatMap(r=>r.sector))).sort();
const STOPWORDS = new Set(["–Ω–∞–π–¥–∏","–Ω–∞–π—Ç–∏","–∏—â—É","–∫–æ–º–ø–∞–Ω–∏—è","–∫–æ–º–ø–∞–Ω–∏–∏","–∑–∞–Ω–∏–º–∞—é—â–∏–µ—Å—è","–∑–∞–Ω–∏–º–∞–µ—Ç—Å—è","–∑–∞–Ω–∏–º–∞—é—Ç—Å—è","–∫–æ—Ç–æ—Ä—ã–µ","–ø–æ","–≤","–∏","—Å","–Ω–∞","–ø—Ä–æ","–æ","–¥–ª—è","–∏–∑","—Å—Ñ–µ—Ä–∞","–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏","find","company","companies","looking"]);

/* ======= DOM ======= */
const chipsEl = document.getElementById('chips');
const colsEl  = document.getElementById('cards');
const aiBox   = document.getElementById('aiBox');
const aiText  = document.getElementById('aiText');
const qEl     = document.getElementById('q');
const runBtn  = document.getElementById('run');
const resetBtn= document.getElementById('reset');
const placeholderEl = document.getElementById('placeholder');
const modeAIEl = document.getElementById('mode-ai');
const modeFiltersEl = document.getElementById('mode-filters');

let mode='ai';
let activeTags = new Set();

/* ======= UI ======= */
function renderChips(){
  chipsEl.innerHTML='';
  ALL_TAGS.forEach(tag=>{
    const b=document.createElement('button');
    b.className='chip'; b.textContent=tag;
    b.onclick=()=>{ if(activeTags.has(tag)){activeTags.delete(tag); b.classList.remove('active');} else {activeTags.add(tag); b.classList.add('active');}
      if(mode==='filters') runSearch();
    };
    chipsEl.appendChild(b);
  });
}

function residencyPillClass(status){ return status==='lead' ? 'pill blue' : 'pill green'; }
function cardTemplate(r){
  return `<div class="card">
    <div class="fp-badge">Focal: ${r.focal}</div>
    <div class="row"><div class="title">${r.name}</div><span class="${residencyPillClass(r.status)}">${r.region}</span></div>
    <div class="row">${r.sector.map(s=>`<span class="tag">${s}</span>`).join('')}</div>
    <div style="color:#64748b">${r.extra} ‚Ä¢ –ö–æ–Ω—Ç–∞–∫—Ç: ${r.contact}</div>
  </div>`;
}

function renderSkeletons(){
  colsEl.style.display='grid';
  colsEl.innerHTML='';
  for(let i=0;i<4;i++){
    colsEl.innerHTML += `<div class="card">
      <div class="skeleton" style="height:18px;width:60%"></div>
      <div class="skeleton" style="height:12px;width:90%"></div>
      <div class="skeleton" style="height:12px;width:70%"></div>
    </div>`;
  }
}

function typewrite(targetEl, text, speed=16){
  targetEl.textContent=''; let i=0; return new Promise(res=>{ const t=setInterval(()=>{ targetEl.textContent += text[i++]||''; if(i>=text.length){clearInterval(t); res();}}, speed); });
}

/* ======= SEARCH ======= */
function normalize(s){ return (s||'').toString().toLowerCase().replace('—ë','–µ'); }
function tokenize(q){ return normalize(q).split(/[^a-z–∞-—è0-9—ë-]+/i).filter(w=>w && w.length>1 && !STOPWORDS.has(w)); }

function applySpecialFilters(arr, q){
  const nq = normalize(q);
  const hasMukhlisa = /(–º—É—Ö–ª–∏—Å|mukhlisa)/i.test(nq);
  const hasERP = /(\berp\b|–µ—Ä–ø)/i.test(nq);
  let res = arr;
  if(hasMukhlisa){ res = res.filter(it => normalize(it.focal).includes('mukhlisa')); }
  if(hasERP){ res = res.filter(it => (it.sector||[]).some(s => normalize(s).includes('erp'))); }
  return {res, hasMukhlisa, hasERP};
}

function scoreItem(r, tokens, bonuses){
  const hay = normalize([r.name,r.region,r.contact,r.extra,(r.focal||''),(r.sector||[]).join(' ')].join(' '));
  let s = 0;
  tokens.forEach(t=>{
    if(normalize(r.name).includes(t)) s += 3;
    if((r.sector||[]).some(x=>normalize(x).includes(t))) s += 2;
    if(normalize(r.focal||'').includes(t)) s += 4;
    if(hay.includes(t)) s += 1;
  });
  if(bonuses.hasERP) s += 2;
  if(bonuses.hasMukhlisa) s += 3;
  return s;
}

function searchAI(q){
  let {res, hasMukhlisa, hasERP} = applySpecialFilters(RESIDENTS, q);
  const rawTokens = tokenize(q).filter(t=>t!=='erp' && t!=='–µ—Ä–ø' && t!=='mukhlisa' && t!=='–º—É—Ö–ª–∏—Å–∞');
  if(rawTokens.length===0){ return res; }
  const scored = res.map(r=>({r, s:scoreItem(r, rawTokens, {hasERP, hasMukhlisa})})).sort((a,b)=>b.s-a.s);
  const maxS = scored.length? scored[0].s : 0;
  const filtered = scored.filter(x=>x.s>0);
  return (filtered.length? filtered : scored).map(x=>x.r);
}

function searchByFilters(q){
  let arr = RESIDENTS;
  if(activeTags.size){ arr = arr.filter(r => [...activeTags].every(t=> (r.sector||[]).includes(t))); }
  const {res} = applySpecialFilters(arr, q);
  const tokens = tokenize(q);
  if(tokens.length===0) return res;
  return res.filter(r=>{
    const hay = normalize([r.name,r.region,r.contact,r.extra,(r.focal||''),(r.sector||[]).join(' ')].join(' '));
    return tokens.some(t=> hay.includes(t));
  });
}

/* ======= RUN / RESET ======= */
async function runSearch(){
  const q = qEl.value || '';
  placeholderEl.style.display='none';
  colsEl.style.display='grid';

  renderSkeletons();

  if(mode==='ai'){
    chipsEl.style.display='none';
    aiBox.style.display='';
    const narrative = `–ó–∞–ø—Ä–æ—Å: ¬´${q.trim()||'‚Äî'}¬ª. –ü–æ–¥–±–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω —Å —É—á—ë—Ç–æ–º –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤, –æ—Ç—Ä–∞—Å–ª–µ–≤—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ª–∏—Ü.`;
    await new Promise(r=>setTimeout(r,350));
    await typewrite(aiText, narrative);
    const items = searchAI(q);
    colsEl.innerHTML = items.length ? items.map(cardTemplate).join('') : `<div class="placeholder">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>`;
  } else {
    chipsEl.style.display='flex';
    aiBox.style.display='none';
    await new Promise(r=>setTimeout(r,300));
    const items = searchByFilters(q);
    colsEl.innerHTML = items.length ? items.map(cardTemplate).join('') : `<div class="placeholder">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>`;
  }
}

function resetAll(){
  qEl.value=''; activeTags.clear();
  Array.from(chipsEl.querySelectorAll('.chip')).forEach(c=>c.classList.remove('active'));
  colsEl.style.display='none'; colsEl.innerHTML='';
  aiText.textContent=''; aiBox.style.display='none';
  placeholderEl.style.display='block';
}

modeAIEl.onclick = ()=>{ mode='ai'; modeAIEl.classList.add('active'); modeFiltersEl.classList.remove('active'); chipsEl.style.display='none'; };
modeFiltersEl.onclick = ()=>{ mode='filters'; modeFiltersEl.classList.add('active'); modeAIEl.classList.remove('active'); chipsEl.style.display='flex'; };
runBtn.onclick = runSearch; resetBtn.onclick = resetAll; qEl.addEventListener('keydown', e=>{ if(e.key==='Enter') runSearch();});

/* INIT */
renderChips();
</script>
</body>
</html>
